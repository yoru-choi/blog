
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>[ Node ]  node에서 euc-kr response 받고 utf-8로 변경하기  - YEOL</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">[ Node ]  node에서 euc-kr response 받고 utf-8로 변경하기  - YEOL</h2>
                                <div class="box-info">
                                    <p class="category">TS, JS/nodejs</p>
                                    <p class="date">2022-08-22 16:56:07</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <h4 data-ke-size="size20">?<span>&nbsp;</span><b>환경&nbsp;</b></h4>
<p data-ke-size="size16">Mac M1<br />Node 16<br />VsCode</p>
<h4 data-ke-size="size20">? <b>개요</b></h4>
<p data-ke-size="size16">Node에서 axios를 사용할 때 response값이 <span>euc-kr<span>일 경우 utf-8로 바꾸기!</span></span></p>
<h4 data-ke-size="size20">?<span>&nbsp;</span><b>목차</b></h4>
<ul style="list-style-type: disc;" data-ke-list-type="disc">
<li>decode 할 소스 만들기</li>
<li>결과 확인하기</li>
</ul>
<h2 data-ke-size="size26">&nbsp;</h2>
<h2 data-ke-size="size26"><b>-  decode 할 소스 만들기</b></h2>
<p data-ke-size="size16">필요한 lib를 추가해줍시다. restApi와 decode를 위한 lib입니다.</p>
<pre id="code_1661154521756" class="typescript" data-ke-language="typescript" data-ke-type="codeblock"><code>npm install express --save
npm install axios --save
npm install iconv-lite --save</code></pre>
<p data-ke-size="size16"><span style="font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Apple SD Gothic Neo', Arial, sans-serif; letter-spacing: 0px;">node 환경에서 axios를 request 할 수 있는 상황을 만들어줍니다.&nbsp;</span><span style="font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Apple SD Gothic Neo', Arial, sans-serif; letter-spacing: 0px;"></span><span style="font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Apple SD Gothic Neo', Arial, sans-serif; letter-spacing: 0px;"></span></p>
<pre id="code_1661154570820" data-ke-language="bash" data-ke-type="codeblock"><code>  const config: object = {
    method: 'post',
    url,
    headers: {
      'Content-Type': 'application/json',
    },
    params: data,
    responseType: 'arraybuffer',
  };

  const result = await axios(config)
    .then(async (res: any) =&gt; {
      const resData = iconv.decode(res.data, 'euc-kr');
      console.log(resData);
      return result;
    })
    .catch((err: any) =&gt; {
      console.log(err);
      return err;
    });</code></pre>
<p data-ke-size="size16">&nbsp;</p>
<h2 data-ke-size="size26"><b>-  결과 확인하기</b></h2>
<p data-ke-size="size16"><span style="font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Apple SD Gothic Neo', Arial, sans-serif; letter-spacing: 0px;">해당 소스를 postman으로 실행하거나 서버 구조 없이 함수로 실행하면 결괏값을 알 수 있습니다.</span></p>
<p data-ke-size="size16"><span style="font-family: -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'Apple SD Gothic Neo', Arial, sans-serif; letter-spacing: 0px;">설명을 추가하자면 돌아오는 값이 euc-kr일 경우 responseType을 arraybuffer로 꼭 받아줘야 합니다.<br />위의 이유를 설명드리자면 response를 받을 때<br />responseType에 대한 기본값이 있는듯합니다. 그래서 들어오는 euc-kr 값을 내부적으로 <br />설정된 기본 타입으로 받기 때문에 데이터가 깨지게 됩니다.&nbsp;<br />그 데이터를 response에서 받고 iconv로 디코딩하면 문제가 됩니다.<br />arraybuffer로 받는 타입을 지정해줘야 깨지지 않은 온전한 값을 이용해 iconv로 디코딩 가능합니다.</span></p>
<p data-ke-size="size16"><s>pg사때문에 euc-kr 디코딩하는 사람 꽤 있는 거 같아요~</s></p>
<p data-ke-size="size16">&nbsp;</p>
<p data-ke-size="size16"><b><span style="background-color: #ffffff; color: #555555;">? 근거 있는 조언은 언제나 환영합니다</span><span style="background-color: #ffffff; color: #555555;">. 성실한 코딩</span><span style="background-color: #ffffff; color: #555555;"><span>&nbsp;</span>하세요.</span></b></p>
                        </div>
                        <br/>
                        <div class="tags">
                            #node euckr #node euc-kr #node euc-kr 인코딩 
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
