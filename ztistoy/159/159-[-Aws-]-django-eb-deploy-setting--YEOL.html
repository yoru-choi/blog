
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>[ Aws ] django eb deploy setting- YEOL</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">[ Aws ] django eb deploy setting- YEOL</h2>
                                <div class="box-info">
                                    <p class="category">Cloud</p>
                                    <p class="date">2023-01-18 10:20:49</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <h4 data-original-attrs="{&quot;data-ke-size&quot;:&quot;size20&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size20">?&nbsp;<b>환경&nbsp;</b></h4>
<p data-original-attrs="{&quot;data-ke-size&quot;:&quot;size16&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size16">Python 3.8<br />VsCode<br />ELB</p>
<h4 data-original-attrs="{&quot;data-ke-size&quot;:&quot;size20&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size20">?&nbsp;<b>개요</b></h4>
<p data-original-attrs="{&quot;data-ke-size&quot;:&quot;size16&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size16">Django를 eb에서 실행하기 위한 세팅을 진행합니다.&nbsp;</p>
<h4 data-original-attrs="{&quot;data-ke-size&quot;:&quot;size20&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size20">?&nbsp;<b>목차</b></h4>
<ul style="list-style-type: disc;" data-original-attrs="{&quot;data-ke-list-type&quot;:&quot;disc&quot;,&quot;data-mce-style&quot;:&quot;list-style-type: disc;&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-list-type="disc">
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">eb deploy setting</li>
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">보기 참조</li>
</ul>
<div><b>&nbsp;</b></div>
<h2 data-original-attrs="{&quot;data-ke-size&quot;:&quot;size26&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size26"><b>- eb deploy setting</b></h2>
<p data-ke-size="size16"><b>보기는 하단 참조</b></p>
<ol style="list-style-type: decimal;" data-ke-list-type="decimal">
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">eb cli 설치</li>
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">프로젝트에서 명령어-&gt; eb init 하고 설명에 맞게 진행<br />Do you wish to continue with CodeCommit? N을 눌러줍니다<br />저장소를 Aws의 코드커밋으로 하겠냐는 질문</li>
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">. elasticbeanstalk내부에 config.yml 파일 생성됨</li>
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">. ebignore eb에 올라가지 않아도 될 파일 생성 -&gt; e.g) 5번 보기</li>
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">. ebextensions&nbsp; eb에 사용될 pakaage 혹은 data 설정 -&gt; e.g) 6번 보기<br />├──&nbsp;01_package.config<br />├──&nbsp;02_gunicorn.config<br />└──&nbsp;03_env.config</li>
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">. platform eb에서 사용될 deploy 단계에 맞게 실행할 명령어 설정<br /><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/platforms-linux-extend.html" target="_blank" rel="noopener">aws_postdeploy_link</a> 사용법 링크<br />├──&nbsp;hooks<br />&nbsp;│&nbsp;&nbsp;&nbsp;└── postdeploy<br />&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;├── 01_env.sh<br />&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└── 02_gunicorn.sh<br />└──&nbsp;nginx<br />&nbsp;&nbsp;&nbsp;&nbsp;└──&nbsp;conf.d<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└──&nbsp;elasticbeanstalk<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└──&nbsp;nginx_custom.conf</li>
<li data-original-attrs="{&quot;style&quot;:&quot;&quot;}">eb deploy</li>
</ol>
<p data-original-attrs="{&quot;data-ke-size&quot;:&quot;size16&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size16">&nbsp;</p>
<h2 data-original-attrs="{&quot;data-ke-size&quot;:&quot;size26&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size26"><b>- 보기 참조</b></h2>
<pre id="code_1673937549240" class="python" data-original-attrs="{&quot;contenteditable&quot;:&quot;false&quot;,&quot;data-ke-language&quot;:&quot;bash&quot;,&quot;data-ke-type&quot;:&quot;codeblock&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-language="python"><code># 4번 보기
# file_name: .ebignore

.env
.git
.gitignore 
/venv</code></pre>
<pre id="code_1673941159186" class="python" data-ke-language="python" data-ke-type="codeblock"><code># 5번 보기
# file_name: 01_package.config

commands:
  01-command:
    command: sudo yum install -y mysql-devel
  02-command:
    command: sudo yum install -y jq</code></pre>
<pre id="code_1673941162286" class="python" data-ke-language="python" data-ke-type="codeblock"><code># 5번 보기
# file_name: 02_gunicorn.config

files:
  "/etc/systemd/system/gunicorn.service":
    mode: "000755"
    owner: root
    group: root
    content: |
      [Unit]
      Description=gunicorn daemon
      After=network.target
      
      [Service]
      WorkingDirectory=/var/app/current/&lt;project_name&gt; #project path
      Environment="DJANGO_SETTINGS_MODULE=&lt;project_name&gt;.settings.local" #project settings path
      ExecStart=/var/app/venv/staging-LQM1lest/bin/gunicorn \      #venv gunicorn path
      --workers 3 --bind 0.0.0.0:8000 &lt;project_name&gt;.wsgi:application --timeout 120
      
      [Install]
      WantedBy=multi-user.target
      
container_commands:
  1_command:
    command: "systemctl enable gunicorn"
  2_command:
    command: "systemctl start gunicorn"</code></pre>
<pre id="code_1673941162822" class="python" data-ke-language="python" data-ke-type="codeblock"><code># 5번 보기
# file_name: 03_env.config

option_settings:
  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: &lt;project_name&gt;.settings.local
    LOCAL_ENV : False
    DB_NAME_DEV : test_db_name</code></pre>
<pre id="code_1674004385706" class="python" data-ke-language="python" data-ke-type="codeblock"><code># 6번 보기
# file_name: 01_env.sh
# env를 읽어 사용할 디렉토리에 카피하는 작업, 아래 3줄 한줄로 만들어서 사용

#!/bin/sh
/opt/elasticbeanstalk/bin/get-config environment
| jq -r 'to_entries | .[] | "\(.key) = \"\(.value)\""' &gt; 
/var/app/current/&lt;project_name&gt;/.env</code></pre>
<pre id="code_1674004594717" class="bash" data-ke-language="python" data-ke-type="codeblock"><code># 6번 보기
# file_name: 01_gunicorn.sh
# deploy가 끝나고 restart

#!/bin/sh
sudo systemctl restart gunicorn</code></pre>
<pre id="code_1674004389986" class="python" data-ke-language="python" data-ke-type="codeblock"><code># 6번 보기
# file_name: nginx_custom.conf
# nginx custom setting 필요할때 사용</code></pre>
<p data-ke-size="size16">&nbsp;</p>
<p data-original-attrs="{&quot;data-ke-size&quot;:&quot;size16&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size16">&nbsp;</p>
<p data-original-attrs="{&quot;data-ke-size&quot;:&quot;size16&quot;,&quot;style&quot;:&quot;&quot;}" data-ke-size="size16"><b>? 근거 있는 조언은 언제나 환영합니다. 성실한 코딩&nbsp;하세요.</b></p>
                        </div>
                        <br/>
                        <div class="tags">
                            #eb deploy setting django #django eb deploy 
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
