
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>react Context API 이해하기 - YEOL</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">react Context API 이해하기 - YEOL</h2>
                                <div class="box-info">
                                    <p class="category">TS, JS/react</p>
                                    <p class="date">2020-06-15 15:12:26</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <p>&nbsp;</p>
<p>&nbsp;</p>
<p><figure class="imageblock alignCenter" data-filename="react.png" data-origin-width="632" data-origin-height="602" width="445" height="NaN" data-ke-mobilestyle="widthContent">
    <span data-lightbox="lightbox">
        <img src="./img/img.png" data-filename="react.png" data-origin-width="632" data-origin-height="602" width="445" height="NaN" data-ke-mobilestyle="widthContent" />
    </span>
    <figcaption></figcaption>
</figure></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><b>이번에 설명해볼 내용은 Context API에 관해서입니다.</b></p>
<p>redux와 같은 상태 관리를 위한 라이브러리입니다. react의 내장 라이브러리로서 사용 가능합니다.</p>
<p>&nbsp;</p>
<p>create-react-app으로 리액트 프로젝트를 하나 생성해줍시다. 후에</p>
<pre id="code_1592199475784" class="html xml" data-ke-language="html" data-ke-type="codeblock"><code>import React, {createContext, useState} from 'react';

const ColorContext = createContext({color:'pink'});

export default ColorContext;
</code></pre>
<p>위와 같은 js 파일을 하나 생성합니다.</p>
<p>createContext는 초기값 설정이라고 보시면 됩니다. json 타입으로 color를 pink로 초기화해주었습니다.</p>
<pre id="code_1592199615136" class="html xml" data-ke-language="html" data-ke-type="codeblock"><code>import React from 'react';
import ColorContext from './Color';

const App=()=&gt;{

        return(
        	&lt;div&gt;
              &lt;ColorContext.Consumer&gt;
              { value=&gt;(&lt;div style={{width:'60px' ,height:'50px' , background: value.color }}/&gt;)}
              &lt;/ColorContext.Consumer&gt;
            &lt;/div&gt;
        )
}
export default App;</code></pre>
<p>간단하게 App에다 바로 넣어주었습니다. createContext의 Consumer를 사용하면</p>
<p>children처럼 컴포넌트 내부에서 value값을 가져올 수 있습니다. 하지만</p>
<p>중괄호 하나를 더생성하고 컴포넌트를 불러주어 그 안에 value.color값을 넣어주었습니다.</p>
<p>이런 패턴을 Render Props라고 합니다.</p>
<p>&nbsp;</p>
<p>쉽게 생각하면 전역 변수를 가져와서 사용한 것입니다.</p>
<p>여기서 초기값을 변경하는 법이 있습니다.</p>
<pre id="code_1592200446548" class="html xml" data-ke-language="html" data-ke-type="codeblock"><code>import React from 'react';
import ColorContext from './Color';

const App=()=&gt;{

        return(
        	&lt;div&gt;
            &lt;ColorContext.Provider value={{color:'green' }}&gt;
              &lt;ColorContext.Consumer&gt;
              { value=&gt;(&lt;div style={{width:'60px' ,height:'50px' , background: value.color }}/&gt;)}
              &lt;/ColorContext.Consumer&gt;
            &lt;/ColorContext.Provider&gt;
          &lt;/div&gt;
        )
}
export default App;</code></pre>
<p>Provider를 이용하는 것입니다. 전부 createContext를 기준으로 한 컴포넌트로 사용되는 것을 볼 수 있습니다.</p>
<p>Provider를 사용하면 Context에 초기값이 있다면 대신하고 없으면 채워주는 컴포넌트입니다.</p>
<p>&nbsp;</p>
<p>벌써 사용법과 변경법을 끝냈습니다. 아주 간단하고 이해하기 쉽게 적었기 때문에 쓸모없어 보이고</p>
<p>감이 오지 않을 수 있습니다.</p>
<p>&nbsp;</p>
<p>그런 분들을 위해 밑의 3가지 파일을 준비했습니다.</p>
<p><b>첫 번째 컴포넌트입니다.</b></p>
<pre id="code_1592200859646" class="html xml" style="display: block; overflow: auto; padding: 15px; color: #383a42; background: #f6f7f8; font-size: 14px; border-radius: 3px; font-family: Menlo, Consolas, Monaco, monospace; border: 1px solid #dddddd; margin: 20px auto 0px; cursor: default; z-index: 1; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" data-ke-language="html" data-ke-type="codeblock"><code>import React from 'react'
import {ColorConsumer} from './Color'

const ColorBox =()=&gt;{

  return (
        &lt;ColorConsumer&gt;
              { ({state}) =&gt;(
                &lt;&gt;
                &lt;div  style={{ width:'64px' , height:'64px', background: state.color}} /&gt;
                &lt;div  style={{ width:'32px' , height:'32px', background: state.subcolor}} /&gt;
                &lt;/&gt;
            )}
        &lt;/ColorConsumer&gt;
  );
}
export default ColorBox;
</code></pre>
<p>&nbsp;</p>
<p>&nbsp;ColorBox라는 보여주기 전용 컴포넌트를 작성합니다.</p>
<p>ColorConsumer는 아래와 같은 코드 중 하나를 선언을 했기 때문에 사용 가능합니다.</p>
<p>const ColorConsumer = ColorContext.Consumer;&nbsp; &nbsp;//아래의 코드와 같음</p>
<p>const {Consumer: ColorConsumer} = ColorContext; <span style="color: #333333;">//위의 코드와 같음</span></p>
<p>즉 <span style="color: #333333;">ColorContext.Consumer 컴포넌트에서 value가 아닌 state 기준으로 보여줍니다.</span></p>
<p>&nbsp;</p>
<p><b>2번째 컴포넌트입니다.</b></p>
<pre id="code_1592200809466" class="html xml" data-ke-language="html" data-ke-type="codeblock"><code> import React, {createContext, useState} from 'react';

const ColorContext = createContext({

    state:{color: 'black' , subcolor: 'red'},
    action: {
        setColor: ()=&gt;{},
        setSubcolor:()=&gt;{}
    }
  });



const ColorProvider = ({children})=&gt;{
      const [color , setColor] = useState('black');
      const [subcolor , setSubcolor] = useState('red');

      const value = {
        state:{color, subcolor},
        action: {setColor , setSubcolor}
      };

    return(
      &lt;ColorContext.Provider value={value} &gt;{children}&lt;/ColorContext.Provider&gt;
    );
};

const {Consumer: ColorConsumer} = ColorContext;
export {ColorProvider, ColorConsumer};
export default ColorContext;
</code></pre>
<p>&nbsp;</p>
<p>useState를 사용해줍니다. 초기값을 createContext로 설정해준 다음&nbsp;</p>
<p>하단부에 Provider를 바로 만들어줍니다.&nbsp; value를 그냥 써도 되지만 redux처럼 구분 지어줘서 사용하기 위해</p>
<p>value내에 state와 action을 나눠줬습니다.</p>
<p>&nbsp;</p>
<pre id="code_1592201038545" class="html xml" style="display: block; overflow: auto; padding: 15px; color: #383a42; background: #f6f7f8; font-size: 14px; border-radius: 3px; font-family: Menlo, Consolas, Monaco, monospace; border: 1px solid #dddddd; margin: 20px auto 0px; cursor: default; z-index: 1; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;" data-ke-language="html" data-ke-type="codeblock"><code>import React, {useState} from 'react'
import ColorBox from './ColorBox';
import {ColorProvider , ColorConsumer} from './Color'

const App =()=&gt;{

  return (
        &lt;div&gt;
          &lt;ColorProvider&gt;
          &lt;div&gt;
              &lt;ColorBox /&gt;
          &lt;/div&gt;

            &lt;ColorConsumer&gt;
              { ({action})=&gt;(&lt;button onClick={()=&gt;{action.setColor('blue') }}&gt;asdf&lt;/button&gt;)}
            &lt;/ColorConsumer&gt;
          &lt;/ColorProvider&gt;
        &lt;/div&gt;
      );
}
export default App;
 
</code></pre>
<p>&nbsp;</p>
<p><b>마지막으로 출력하는 부분입니다.</b> App 컴포넌트에 종합하는 부분입니다.&nbsp; 단,</p>
<p>action을 이용하여 useState를 사용해주기 때문에 값을 변경 가능합니다.&nbsp; 이로서 redux와 비슷한 기능을</p>
<p>간단하게 사용할 수 있는 것입니다. 간편한 기능일 경우 redux와 성능 편차가 크지 않습니다.</p>
<p>&nbsp;</p>
<p>hooks처럼 context도 발전 가능성이 높으니 짚고 넘어가면 좋다고 생각합니다.</p>
                        </div>
                        <br/>
                        <div class="tags">
                            #react context #context api #react context api 
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
